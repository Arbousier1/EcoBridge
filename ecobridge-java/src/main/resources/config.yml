# ============================================================
# EcoBridge Configuration v0.9.1 (Macro Adaptive Edition)
# Kernel: Java 25 (FFM/Loom) + Rust (SIMD/Rayon) + Redis
# ============================================================

# [系统内核设置]
system:
  debug: false
  # 经济日志采样率 (0-100)
  log-sample-rate: 100
  # 交易节流：防止短时间内高频点击 UI 冲击内核演算 (ms)
  trade-throttle-ms: 100
  # 是否记录每笔交易到 DuckDB (Native 存储)
  log-transactions: true
  # 拦截并实施审计的命令
  intercept-commands:
    - "pay"
    - "transfer"
    - "epay"
    - "auditpay"

# [分布式同步 (Redis)]
redis:
  enabled: true
  host: "127.0.0.1"
  port: 6379
  user: ""
  password: ""
  ssl: false
  # 多服同步标识，建议每个子服唯一
  server-id: "survival-01"
  channels:
    trade: "ecobridge:global_trade"

# [数据库 (HikariCP + Virtual Threads)]
database:
  host: "localhost"
  port: 3306
  database: "ecobridge"
  username: "root"
  password: "your_strong_password"
  pool-size: 15

# [经济核心模型]
economy:
  currency-id: "coins"
  
  # --- 1. 宏观调控中心 (Macro Control) ---
  macro:
    # 目标全服流速 (V): 每秒每人平均交易额。基于费雪方程式 (MV=PQ)
    # 0.04 表示 100 个人在线时，全服每秒产生 4.0 的交易流量为平衡态
    target-velocity: 0.04
    # 单用户容量：计算生态饱和度 (Saturation) 的基准值
    capacity-per-user: 5000.0
    # 财富流速感应灵敏度：值越高，物价对大户抛售的反应越剧烈
    heat-sensitivity: 0.5
    # 恐慌抑制阈值：价格加速度超过此值将强制触发 Rust 阻尼器 (Panic Suppression)
    panic-threshold: 50.0

  # --- 2. 物理控制器参数 (PID State) ---
  # 这些参数直接注入 Rust 的 PidState 结构体
  pid:
    kp: 0.4   # 比例增益：决定价格随供需变化的“弹性”
    ki: 0.08   # 积分增益：消除长期物价偏差（防通缩/死水）
    kd: 0.15  # 微分增益：预测趋势，平抑瞬间跳变
    lambda: 0.01 # 漏损系数：模拟货币在流通中的自然损耗

  # --- 3. 基础市场参数 ---
  # 货币供应量 M1 基准
  m1-supply: 10000000.0
  # 波动触发阈值 (单笔交易)
  volatility-threshold: 50000.0
  # 每日热度自然衰减率
  decay-rate: 0.05
  # 默认流动性系数 (微观价格斜率)
  default-lambda: 0.002
  # 时间衰减常数 (历史权重半衰期)
  tau: 7.0
  # 全局出售折扣率
  sell-ratio: 0.5

  # --- 4. 环境扰动因子 (MarketConfig) ---
  environment:
    seasonal-amplitude: 0.15
    weekend-multiplier: 1.2
    newbie-protection: 0.2
    force-festival-mode: false

  # --- 5. 批处理与历史 ---
  history:
    # 演算快照保留天数
    days-limit: 30
    # 内存中活跃缓存的最大条数
    max-records: 3000

  # --- 6. 金融风控审计 (RegulatorConfig) ---
  audit-settings:
    # 所有转账的基础税率
    base-tax-rate: 0.05
    # 单笔转账金额超过此阈值时，开始征收豪华税
    luxury-threshold: 100000.0
    # 豪华税的税率
    luxury-tax-rate: 0.10
    # 财富差距税的税率，对从富人流向穷人的资金征税
    wealth-gap-tax-rate: 0.20
    # 被认定为“穷人”的资产阈值
    poor-threshold: 10000.0
    # 被认定为“富人”的资产阈值
    rich-threshold: 1000000.0
    # [校准] 新手玩家单次接收转账的最大限额 (对应 TransferManager.java)
    # 已修正为 'newbie-limit' (原 newbie-receive-limit)
    newbie-limit: 50000.0
    # [Rust 硬编码] 警告比率目前在 Rust 内核中固定为 0.9，此处配置暂不生效
    # warning-ratio: 0.9 
    # 触发高风险警告的最低金额
    warning-min-amount: 50000.0
    # 频率审计阈值：玩家每秒转账频率超过此值将被拦截
    velocity-threshold: 20.0
    newbie-hours: 10.0
    # 被认定为“老手”的游玩小时数下限
    veteran-hours: 100.0

# [物品特定覆盖配置]
item-settings:
  miner_shop:
    diamond:
      lambda: 0.0001
      weights:
        seasonal: 0.0
        inflation: 0.5

# [内部状态 - 请勿手动修改]
internal:
  economy-heat: 0.0